# 学了吗APP - 规范要求文档

## 概述

本文档定义了开发"学了吗APP"所需的各项规范要求，包括功能规范、Flutter代码规范、UI设计规范、数据规范等。

---

## 一、功能规范要求

### 1.1 核心功能模块

#### 1. 拖延治愈系统

| 功能 | 说明 | 优先级 |
|------|------|--------|
| 任务拆解 | 支持大任务拆分为小任务 | P0 |
| 强制提醒 | 任务开始前5分钟提醒 | P0 |
| 番茄专注 | 25分钟专注+5分钟休息 | P0 |
| 防分心锁定 | 专注期间锁定娱乐APP | P1 |
| 打卡闭环 | 每日打卡、学习报告 | P0 |
| 奖惩机制 | 积分、虚拟奖励 | P1 |
| 心理疏导 | 拖延急救短音频 | P2 |

#### 2. 知识点精准补漏系统

| 功能 | 说明 | 优先级 |
|------|------|--------|
| 全学段知识点库 | 小学至大学、考证 | P0 |
| 知识点搜索 | 1秒定位 | P0 |
| 自测功能 | 5-10题/章节 | P0 |
| 漏洞报告 | 标注掌握程度 | P0 |
| 思维导图 | 自动生成框架 | P1 |
| 错题本 | 错题分类整理 | P0 |

#### 3. 试题格式支持（混合格式）

| 类型 | 格式 | 说明 |
|------|------|------|
| **数学公式** | LaTeX | 使用 `\LaTeX` 语法，如 `\int_0^1 x^2 dx` |
| **几何图形** | 图片附件 | 支持 `.png`, `.jpg`, `.jpeg` 格式 |
| **函数图像** | 图片附件 | 高清图片，支持缩放 |
| **化学方程式** | LaTeX | 使用 `\mathrm{H_2O}` 等语法 |
| **分子结构** | 图片附件 | 支持化学结构图 |
| **物理电路图** | 图片附件 | 支持电路图、力学图 |

#### 试题JSON格式示例
```json
{
  "id": "math_001",
  "subject": "数学",
  "grade": "初三",
  "title": "二次函数综合题",
  "type": "解答题",
  "difficulty": "中等",
  
  "content": {
    "text": "已知函数 f(x) = ax² + bx + c...",
    "formulas": [
      "f(x) = ax^2 + bx + c",
      "\\Delta = b^2 - 4ac"
    ]
  },
  
  "images": [
    {
      "id": "img_001",
      "filename": "function_graph.png",
      "type": "函数图像",
      "position": "content"
    }
  ],
  
  "answer": {
    "formula": "x_1 = \\frac{-b + \\sqrt{\\Delta}}{2a}",
    "explanation": "使用求根公式..."
  }
}
```

#### 3. 科学规划模块

| 功能 | 说明 | 优先级 |
|------|------|--------|
| 目标设置 | 短期/长期目标 | P0 |
| 计划生成 | 自动生成每日/每周计划 | P0 |
| 动态调整 | 根据学习节奏调整 | P1 |
| 目标报告 | 每月完成报告 | P1 |

#### 4. 高效复盘模块

| 功能 | 说明 | 优先级 |
|------|------|--------|
| 复盘模板 | 每日/每周/每月复盘 | P0 |
| 自动保存 | 复盘内容保存 | P0 |
| 进度查看 | 历史复盘查看 | P1 |

#### 5. 学习资源库

| 功能 | 说明 | 优先级 |
|------|------|--------|
| 资源分类 | 按学段、学科分类 | P1 |
| 资源下载 | 免费/付费下载 | P1 |
| 资源上传 | 用户上传、积分兑换 | P2 |

### 1.2 用户系统

| 功能 | 说明 | 优先级 |
|------|------|--------|
| 用户注册/登录 | 基础用户系统 | P0 |
| 个人中心 | 个人信息、积分 | P0 |
| 好友系统 | 好友管理、小组 | P1 |
| 家长模式 | 家长监督功能 | P2 |

---

## 二、Flutter代码规范

### 2.1 项目结构规范

```
lib/
├── main.dart              # 入口文件
├── app.dart               # App配置
├── config/                # 配置相关
│   └── theme.dart         # 主题配置
├── models/                # 数据模型
│   ├── user_model.dart   # 用户模型
│   ├── task_model.dart   # 任务模型
│   ├── knowledge_model.dart # 知识点模型
│   └── note_model.dart    # 笔记模型
├── screens/               # 页面
│   ├── home_screen.dart  # 首页
│   ├── focus_screen.dart  # 番茄专注
│   ├── knowledge_screen.dart # 知识点库
│   ├── quiz_screen.dart   # 自测
│   ├── mistake_screen.dart # 错题本
│   ├── plan_screen.dart   # 规划
│   ├── review_screen.dart  # 复盘
│   ├── resource_screen.dart # 资源库
│   ├── profile_screen.dart # 个人中心
│   └── friend_screen.dart  # 好友
├── components/            # 通用组件
│   ├── task_card.dart     # 任务卡片
│   ├── knowledge_card.dart # 知识点卡片
│   ├── timer_widget.dart  # 计时器
│   └── stats_chart.dart   # 统计图表
├── services/              # 服务层
│   ├── task_service.dart  # 任务服务
│   ├── user_service.dart  # 用户服务
│   ├── storage_service.dart # 存储服务
│   └── focus_service.dart  # 专注服务
├── utils/                # 工具类
│   └── constants.dart     # 常量
└── l10n/                 # 国际化
    ├── app_en.arb        # 英文
    └── app_zh.arb        # 中文
```

### 2.2 命名规范

| 类型 | 规范 | 示例 |
|------|------|------|
| 页面 | screen_xxx.dart | home_screen.dart |
| 组件 | widget_xxx.dart | task_card.dart |
| 模型 | xxx_model.dart | user_model.dart |
| 服务 | xxx_service.dart | task_service.dart |
| 常量 | kLowerCamelCase | kMaxFocusDuration |

### 2.3 代码格式规范

- 使用Dart格式化工具
- 每行最大100字符
- 使用const构造函数
- 添加必要注释

---

## 三、UI设计规范

### 3.1 设计原则

**极简设计+重点突出**

### 3.2 颜色方案

| 元素 | 颜色代码 | 用途 |
|------|----------|------|
| 主色调 | #4CAF50 | 绿色，代表学习、成长 |
| 辅助色 | #2196F3 | 蓝色，代表专注、冷静 |
| 背景色 | #FAFAFA | 浅灰，页面背景 |
| 卡片背景 | #FFFFFF | 白色，卡片背景 |
| 文字主色 | #333333 | 正文标题 |
| 文字次色 | #666666 | 辅助文字 |
| 成功色 | #4CAF50 | 完成、打卡 |
| 警告色 | #FF9800 | 提醒、待办 |
| 错误色 | #F44336 | 错误、逾期 |

### 3.3 尺寸规范

| 元素 | 尺寸 |
|------|------|
| 图标 | 24x24 |
| 按钮高度 | 48px |
| 卡片内边距 | 16px |
| 列表项高度 | 72px |
| 字体标题 | 20px |
| 字体正文 | 16px |
| 字体说明 | 14px |

### 3.4 界面结构

#### 首页布局
```
┌─────────────────────────┐
│     今日学习任务          │  ← 顶部
├─────────────────────────┤
│  ┌─────┐ ┌─────┐ ┌─────┐│  ← 中间：3个核心功能入口
│  │专注  │ │补漏 │ │复盘 ││
│  │学习 │ │知识点│ │     ││
│  └─────┘ └─────┘ └─────┘│
├─────────────────────────┤
│  打卡提醒  |  今日小目标   │  ← 底部
└─────────────────────────┘
```

#### 底部导航栏（4个入口）
| 标签 | 功能 |
|------|------|
| 首页 | 今日任务、功能入口 |
| 学习 | 知识点库、自测、错题本 |
| 规划 | 目标、计划 |
| 我的 | 个人信息、积分、资源、好友 |

---

## 四、数据规范

### 4.1 数据模型

#### 用户模型
```dart
class User {
  final String id;
  final String name;
  final String email;
  final int points;
  final int streakDays;
  final List<String> achievements;
}
```

#### 任务模型
```dart
class Task {
  final String id;
  final String title;
  final String description;
  final DateTime dueTime;
  final List<String> subtasks;
  final bool isCompleted;
  final int focusMinutes;
}
```

#### 知识点模型
```dart
class KnowledgePoint {
  final String id;
  final String title;
  final String content;
  final String category;
  final String grade;
  final String chapter;
  final List<String> examples;
}
```

### 4.2 本地存储

- 使用SharedPreferences存储用户偏好
- 使用本地数据库（SQLite/Isar）存储任务、知识点、错题
- 数据加密存储敏感信息

---

## 五、性能规范

### 5.1 性能要求

| 指标 | 要求 |
|------|------|
| 冷启动时间 | < 2秒 |
| 页面切换 | < 300ms |
| 包体大小 | < 30MB |
| 内存使用 | < 100MB |

### 5.2 优化策略

- 图片压缩、懒加载
- 列表项缓存
- 数据库索引优化

---

## 六、国际化规范

### 6.1 支持语言

| 语言 | 代码 | 状态 |
|------|------|------|
| 中文 | zh | ✅ 已支持 |
| 英文 | en | ✅ 已支持 |

### 6.2 字符串规范

```arb
{
  "appTitle": "学了吗",
  "@appTitle": {
    "description": "应用标题"
  },
  "todayTasks": "今日学习任务",
  "@todayTasks": {
    "description": "首页任务列表标题"
  },
  "startFocus": "开始专注",
  "@startFocus": {
    "description": "开始专注按钮"
  },
  "knowledgeGap": "知识点补漏",
  "@knowledgeGap": {
    "description": "知识点补漏功能名称"
  },
  "dailyReview": "今日复盘",
  "@dailyReview": {
    "description": "每日复盘标题"
  },
  "focusMode": "专注模式",
  "@focusMode": {
    "description": "番茄钟专注模式"
  },
  "taskCompleted": "任务完成",
  "@taskCompleted": {
    "description": "任务完成提示"
  },
  "streakDays": "连续学习{count}天",
  "@streakDays": {
    "description": "连续学习天数",
    "placeholders": {
      "count": {
        "type": "int"
      }
    }
  }
}
```

### 6.3 英文对照示例

| 中文 | 英文 |
|------|------|
| 学了吗 | Did You Study |
| 今日学习任务 | Today's Tasks |
| 开始专注 | Start Focus |
| 知识点补漏 | Knowledge Gap |
| 今日复盘 | Daily Review |
| 番茄专注 | Pomodoro Focus |
| 任务完成 | Task Completed |
| 连续学习 | Learning Streak |

---

## 七、自动化审核流程

### 7.1 流程规则

```
DEV开始开发
    ↓
开发完成（所有代码文件）
    ↓
ARC自动开始审核
    ↓
┌─ 审核通过 ──┐
│             ↓
↓        继续开发下一批代码
审核不通过
    ↓
DEV修改问题
    ↓
ARC再次审核
    ↓
┌─ 通过 ──┐
↓          ↓
继续      继续修改
```

### 7.2 审核清单

- [ ] 文件命名规范
- [ ] 常量命名规范（k前缀）
- [ ] 文件头注释（@author、@date）
- [ ] 代码格式
- [ ] import语句
- [ ] 注释完整性
- [ ] 异常处理

---

## 八、Google Play规范要求

### 8.1 内容政策

| 类别 | 要求 |
|------|------|
| 教育内容 | 符合教育规范 |
| 隐私合规 | 不收集敏感数据 |
| 年龄分级 | 适合全年龄段 |

### 8.2 技术要求

| 要求 | 说明 |
|------|------|
| Target SDK | API 34+ |
| 包体大小 | < 30MB |
| 64位支持 | 必须支持 |

---

## 九、参考文献

### 9.1 官方文档
- Flutter官方文档
- Dart官方文档

### 9.2 学习类App参考
- 多邻国（游戏化学习）
- Anki（记忆卡片）

---

## 十、技术版本要求

### 10.1 SDK版本

| 技术 | 版本 | 说明 |
|------|------|------|
| Flutter SDK | >=3.24.0 | 稳定版 |
| Dart | >=3.5.0 | 匹配Flutter版本 |
| iOS | >=12.0 | 最低支持版本 |
| Android | API 21+ | 最低支持API |

### 10.2 核心依赖

| 依赖包 | 版本 | 用途 |
|--------|------|------|
| flutter_bloc | ^8.1.3 | 状态管理 |
| provider | ^6.1.1 | 状态管理 |
| sqflite | ^2.3.0 | 本地数据库 |
| shared_preferences | ^2.2.2 | 本地存储 |
| intl | ^0.19.0 | 国际化 |
| flutter_local_notifications | ^17.0.0 | 通知推送 |
| audioplayers | ^6.0.0 | 音频播放 |
| fl_chart | ^0.66.0 | 图表统计 |

---

## 十一、测试规范

### 11.1 测试覆盖率要求

| 测试类型 | 覆盖率要求 |
|----------|------------|
| 单元测试 | > 60% |
| 组件测试 | > 40% |
| 集成测试 | > 30% |

### 11.2 测试用例示例

```dart
void main() {
  group('Task Model', () {
    test('should create task with required fields', () {
      final task = Task(
        id: '1',
        title: '学习数学',
        dueTime: DateTime.now(),
      );
      
      expect(task.id, '1');
      expect(task.title, '学习数学');
      expect(task.isCompleted, false);
    });
  });
}
```

---

## 十二、错误处理规范

### 12.1 错误类型

| 错误类型 | 处理方式 |
|----------|----------|
| 网络错误 | 显示重试提示 |
| 数据库错误 | 记录日志、提示用户 |
| 验证错误 | 显示具体错误信息 |
| 未知错误 | 通用提示、记录日志 |

### 12.2 日志规范

- 使用 `flutter_logger` 或 `print` 进行日志记录
- 区分日志级别：debug、info、warning、error
- 生产环境关闭debug日志

---

**创建日期**: 2026-02-16
**最后更新**: 2026-02-16
**维护者**: OpenClaw团队
