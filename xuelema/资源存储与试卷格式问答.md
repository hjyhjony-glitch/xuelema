# 试题存储与格式问答

## 问题1：图片会压缩吗？资源存储在本地吗？

### 1.1 存储位置

**采用本地存储方案！**

```
手机存储/
├── 学了吗APP/
│   ├── resources/           # 试题资源库
│   │   ├── images/         # 图片资源（压缩存储）
│   │   ├── formulas/        # LaTeX公式缓存
│   │   └── data/           # JSON数据文件
│   │
│   ├── user_data/          # 用户数据
│   │   ├── tasks/          # 任务数据
│   │   ├── mistakes/        # 错题本
│   │   └── progress/       # 学习进度
│   │
│   └── cache/              # 临时缓存
│       ├── ocr_images/      # OCR临时图片
│       └── thumbnails/       # 缩略图
```

### 1.2 图片压缩策略

**自动压缩方案！**

| 图片类型 | 压缩策略 | 最大尺寸 |
|----------|----------|----------|
| 试卷照片 | 高压缩 | 1024px |
| 几何图形 | 中压缩 | 800px |
| 公式截图 | 中压缩 | 600px |
| 缩略图 | 高压缩 | 200px |

**压缩配置**（可在设置中调整）：
```yaml
image_compress:
  max_width: 1024        # 最大宽度
  max_height: 1024        # 最大高度  
  quality: 80           # 质量 80%
  format: jpeg           # 格式
```

### 1.3 存储空间预估

| 内容类型 | 单个大小 | 1000题估计 |
|----------|----------|-------------|
| 文字JSON | 2-5KB | 2-5MB |
| 图片（压缩） | 50-200KB | 50-200MB |
| 公式缓存 | 1-3KB | 1-3MB |
| **总计** | - | **60-210MB** |

### 1.4 用户设置选项

用户可以在"设置"中调整：
```
设置
├── 图片质量
│   ├── 高质量（推荐WiFi）
│   ├── 标准质量（推荐）
│   └── 低质量（省空间）
│
├── 存储管理
│   ├── 查看存储使用情况
│   ├── 清理缓存
│   └── 导出数据
│
└── 离线资源
    ├── 全部下载
    ├── 仅下载今日任务
    └── 不下载（每次在线加载）
```

---

## 问题2：生成的试卷是什么格式？

### 2.1 支持的导出格式

**多种格式可选！**

| 格式 | 特点 | 适用场景 |
|------|------|-----------|
| **PDF** | 跨平台、格式固定 | 打印、分享 |
| **Markdown** | 纯文本、可编辑 | 编辑、转换 |
| **HTML** | 网页格式 | 在线查看 |
| **Word (.docx)** | 可编辑 | 编辑、修改 |
| **图片合集** | 多张图片打包 | 手机查看 |

### 2.2 PDF格式说明

**推荐格式：PDF**

**PDF特性**：
```
├── 页面大小：A4（210 × 297mm）
├── 边距：上下左右各20mm
├── 字体大小：
│   ├── 标题：16pt 加粗
│   ├── 正文：12pt
│   └── 公式：14pt
│
├── 图片：
│   ├── 保持原始比例
│   ├── 最大宽度：160mm
│   └── 清晰度：150dpi
│
└── 目录：
    ├── 自动生成目录
    └── 页码标注
```

### 2.3 试卷模板示例

**PDF试卷结构**：

```
┌─────────────────────────────────────┐
│                                     │
│        江苏省2024年中考模拟试卷           │  ← 标题（16pt）
│              数学                        │
│                                     │
├─────────────────────────────────────┤
│ 班级：__________ 姓名：__________ 分数：______ │  ← 头信息（12pt）
├─────────────────────────────────────┤
│                                     │
│  一、选择题（每题4分，共40分）          │  ← 大标题（14pt）
│                                     │
│  1. 下列说法正确的是（   ）           │  ← 题目（12pt）
│     A. x² = 4                         │
│     B. x² = -4                        │
│     C. (x-1)² = 0                    │  ← 公式（LaTeX渲染）
│     D. |x| = 2                        │
│                                     │
│  2. ...                              │
│                                     │
├─────────────────────────────────────┤
│  二、填空题（每题4分，共20分）          │
│                                     │
│  3. 计算：\int_0^1 x^2 dx = ____     │
│                                     │
├─────────────────────────────────────┤
│  三、解答题（共40分）                  │
│                                     │
│  10. （本题10分）                    │
│     已知函数 f(x) = ax² + bx + c...   │
│                                     │
│     ![函数图像](images/q10.png)       │  ← 图片插入
│                                     │
├─────────────────────────────────────┤
│  参考答案（第X页）                    │
│                                     │
├─────────────────────────────────────┤
│  解析（第X页）                        │
│                                     │
└─────────────────────────────────────┘
```

### 2.4 其他格式示例

#### Markdown格式
```markdown
# 江苏省2024年中考模拟试卷 - 数学

## 一、选择题（每题4分，共40分）

1. 下列说法正确的是（   ）
   - [ ] A. x² = 4
   - [ ] B. x² = -4
   - [ ] C. (x-1)² = 0
   - [ ] D. |x| = 2

## 二、填空题（每题4分，共20分）

3. 计算：\int_0^1 x^2 dx = ____
```

#### HTML格式
```html
<!DOCTYPE html>
<html>
<head>
  <title>江苏省2024年中考模拟试卷 - 数学</title>
  <style>
    body { font-size: 12pt; }
    .formula { font-style: italic; }
    .image { max-width: 100%; }
  </style>
</head>
<body>
  <h1>江苏省2024年中考模拟试卷 - 数学</h1>
  
  <h2>一、选择题（每题4分，共40分）</h2>
  
  <p>1. 下列说法正确的是（   ）</p>
  <ul>
    <li>A. x² = 4</li>
    <li>B. x² = -4</li>
  </ul>
  
  <p>3. 计算：∫₀¹ x² dx = ____</p>
  
  <img src="images/q10.png" alt="第10题图像" />
</body>
</html>
```

---

## 三、用户操作流程

### 3.1 生成试卷步骤

```
1. 选择"生成试卷"
    ↓
2. 选择格式（PDF/Markdown/HTML/Word）
    ↓
3. 选择范围（全部/章节/错题本）
    ↓
4. 点击"生成"
    ↓
5. 预览效果
    ↓
6. 保存/分享
```

### 3.2 分享方式

| 分享方式 | 格式 | 说明 |
|----------|------|------|
| 发送文件 | PDF/Word | 微信、QQ |
| 生成分享链接 | Markdown | 在线查看 |
| 打印 | PDF | 直接打印 |
| 导出到云盘 | PDF | 百度云、iCloud |

---

## 四、技术实现

### 4.1 PDF生成库

| 库 | 语言 | 特点 |
|------|------|------|
| **pdfmake** | Dart | 开源、跨平台 |
| **flutter_pdfview** | Flutter | 原生渲染 |
| **html_to_pdf** | Dart | HTML转PDF |

**推荐**：pdfmake（功能强大，格式控制灵活）

### 4.2 图片压缩库

| 库 | 特点 |
|------|------|
| **flutter_image_compress** | 简单易用 |
| **image** | 功能强大 |
| **smart_image** | 自动压缩 |

**推荐**：flutter_image_compress

### 4.3 本地存储方案

| 方案 | 特点 |
|------|------|
| **Hive** | 轻量级、NoSQL |
| **SQLite** | 关系型、功能强大 |
| **SharedPreferences** | 简单配置 |

**推荐**：SQLite（存储试题关系数据）+ 文件系统（存储图片）

---

## 五、总结

### 5.1 存储策略

| 问题 | 答案 |
|------|------|
| 图片存储 | ✅ **本地存储 + 自动压缩** |
| 压缩策略 | 50-200KB/张（可配置） |
| 存储位置 | 手机内部存储 |
| 空间预估 | 60-210MB（1000题） |

### 5.2 试卷格式

| 问题 | 答案 |
|------|------|
| 主要格式 | ✅ **PDF** |
| 其他格式 | Markdown、HTML、Word、图片合集 |
| PDF特性 | A4、图文混排、页码、目录 |
| 用户选择 | 可在设置中默认格式 |

### 5.3 后续功能

| 功能 | 优先级 | 说明 |
|------|----------|------|
| PDF生成 | P0 | 试卷导出核心功能 |
| 图片压缩 | P1 | 自动压缩上传图片 |
| 存储管理 | P2 | 查看/清理/导出 |
| 离线模式 | P2 | 全离线使用 |

---

**创建日期**: 2026-02-16
**最后更新**: 2026-02-16
